# Dormitory room bot
Телеграм бот созданный для решения насущных проблем, которые могут возникнуть в любой дружной компании.

Cсылка на работающего бота в телеграм - **https://t.me/domestosTbot**

- - -
## Управление долгами
С помощью данного бота больше не придется в попыхах отправлять деньги друг другу после того как кто-то за всех заплатил.
Бот способен на протяжении долгих месяцев запоминать долги внутри одного чата и потом выдавать ***не более n-1 перевода*** для погашения абсолятно всех долгов за этот период. (где n - количество участников в группе)

## Обязанности и задачи
Так же с помощью бота можно создавать напоминалки для каких-то бытовых задач, например выкинуть мусор, задать пул исполнителей и поставить количество исполнителей (2 из 3 например) и затем менять этих двух человек чередовать людьми из этого пула. Так же есть задачи на которые можно подписываться/отписываться если интересуют ее нотификации.

## Общие списки
Если вы вдруг захотели с кем-то вести например спискок фильмов на посмотреть или просто списки с любой полезной информацией так чтобы у каждого это было под рукой и каждый мог добавить что-то туда или посмотреть то вам к dormitory room bot. А самое главное что можно выбрать несколько случайных элементов из любого списка.

## Краткое описание технических деталей
Стэк технологий:
- ***Postgresql***
- ***Mongo-db***
- ***Redis***
- ***Docker***
- ***Gitlab***
- ***Prometheus***
- ***Grafana***

Некоторые подробности:
- Worker pool для параллельной обработки запросов
- Переотправления сообщений с прогрессивным таймаутом на случай каких-то сетевых сбоев итп 
- Транзакции в postgresql
- Pool соеденений с базой данных
- Конфиг в yaml файле


# Список полезных команд:
- ```/register``` - регистрирует тебя в канале в котором ты напишешь это сообщение(необходимо для подсчета долгов)
- ```/bank``` - выводит баланс каждого участиника чата. Елси баланс меньше нуля значит что ты кому-то дожен, если больше то наоборот
- ```/credit @gera @steps @etc 3000``` - говорит, что исполнители после /credit должны тому кто пишет 3000 деленное на их количество
- ```/checkout``` - показывает кто кому сколько должен перевести внутри данного чата. После этого обнуляет все имеющиеся долги в этом чате
- ```/lists``` - выводит все имеющиеся списки
- ```/createl list_id item1 item2```... - создает список в котором уже буду лежать указанные элементы
- ```/addit list_id item``` - добавляет элемент в список
- ```/delit list_id 5``` - удаляет из списка элемент с заданным номером
- ```/randit list_id ```(количество опционально)- выводит случайный элемент из списка"
- ```/tasks``` - выводит все имеющиеся в этом чате задачи в виде нажимающихся кнопок
- ```/task имя_задачи @исполнитель1 @исп2 @исп3 2 2h 04-11-2022+21:08 тут большое описание``` - создает задачку где все опции указанные ниже не обязательные, их можно    писать, а можно и нет(но порядок в котором идут опции оч важен)
    
    @исполнитель1 ... это возможные исполнители данной задачи
	
    следующее число показывает сколько человек в моменте исполняет задачу
	исполнителей можно поменять или прокрутить по циклу если их количество равно цифре после них(лучше попробовать чтобы понять)
	
    далее идет интервал напоминания этой задачи, можно использовать 40s, 20m, 24h
	
    04-11-2022+21:08 - точные дата и время в которое бот напомнит о задаче
	после срабатывания точного времени начнет работать интервал
	
    и наконец сколь угодно большое описание
			
- ```/moment some_task @w1 @w2 @w3 2 2h 04-11-2022+21:08 большое описание``` - cоздает задачку которая исчезает после напоминания
- ```/subt some_task @w1 @w2 @w3 2 2h 04-11-2022+21:08 большое описание``` - cоздает задачку на которую можно подписываться и отписываться